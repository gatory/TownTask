# 小猫精灵图背景处理指南

## 你的问题

你有一个小猫精灵图，背景是复杂的白色和灰色方格模式（透明度棋盘格），不是纯白色背景。

## 解决方案

我为你创建了专门的处理工具来解决这个问题！

### 方法1：使用专门的小猫处理脚本（推荐）

```bash
# 处理单个小猫图片
python3 process_cat.py your_cat_image.png

# 处理整个文件夹的小猫图片
python3 process_cat.py ./your_cat_frames_folder/ --folder
```

这个脚本专门针对你的问题设计：
- ✅ 自动检测复杂的棋盘格背景
- ✅ 智能识别背景颜色模式
- ✅ 保留小猫的细节，只移除背景
- ✅ 自动清理边缘杂点

### 方法2：使用高级图片处理工具

```bash
# 安装依赖（如果需要）
python3 tools/image_processor.py --install-deps

# 处理单个图片，自动选择最佳方法
python3 tools/image_processor.py --process-single your_cat_image.png

# 处理整个文件夹并创建精灵图表
python3 tools/image_processor.py --process-character ./your_cat_frames_folder/
```

## 处理效果预期

### 处理前：
- 小猫周围有白色和灰色的方格背景
- 看起来像在透明度编辑器中的样子

### 处理后：
- 背景完全透明
- 小猫边缘干净
- 保留所有小猫的颜色和细节

## 使用步骤

### 步骤1：准备你的图片
1. 将你的小猫图片放在一个文件夹中
2. 确保文件是PNG格式

### 步骤2：运行处理脚本
```bash
# 如果你有多个小猫帧
python3 process_cat.py ./your_cat_images/ --folder --output ./clean_cat_images/

# 如果只有一个图片
python3 process_cat.py your_cat.png --output clean_cat.png
```

### 步骤3：检查结果
- 处理后的图片会保存在指定位置
- 背景应该是透明的
- 小猫应该保持完整

### 步骤4：创建精灵图表（可选）
```bash
# 将处理后的图片制作成游戏用的精灵图表
python3 tools/image_processor.py --create-sheet ./clean_cat_images/ --output assets/sprites/characters/cat_sprite_sheet.png
```

## 处理原理

### 智能背景检测
1. **边缘采样**：分析图片四个角落的颜色
2. **模式识别**：识别棋盘格、白色、灰色模式
3. **颜色聚类**：找出最常见的背景颜色

### 精确像素处理
1. **颜色匹配**：检查每个像素是否匹配背景颜色
2. **容差处理**：允许一定的颜色变化
3. **边缘清理**：移除孤立的背景残留

### 质量优化
1. **保留细节**：确保小猫的毛发和边缘不被误删
2. **平滑边缘**：清理处理后的锯齿
3. **透明度优化**：确保背景完全透明

## 常见问题

### Q: 小猫的一部分被误删了
**A**: 调整容差参数
```bash
# 编辑 process_cat.py 中的 tolerance 参数
# 默认是25，可以降低到15-20
```

### Q: 背景没有完全清除
**A**: 背景颜色太复杂，尝试手动指定
```bash
# 可以在脚本中添加更多背景颜色
background_colors = [(255, 255, 255), (192, 192, 192), (224, 224, 224), (240, 240, 240)]
```

### Q: 处理后边缘有锯齿
**A**: 这是正常的，游戏引擎会自动平滑处理

## 测试你的结果

处理完成后，你可以：

1. **在图片查看器中查看**：背景应该显示为透明（通常是棋盘格）
2. **在游戏中测试**：将精灵图表放入游戏，小猫应该没有白色方块背景
3. **检查文件大小**：PNG文件应该支持透明度

## 下一步

处理完小猫精灵图后：

1. **更新游戏配置**：编辑 `assets/config/character_config.json`
2. **测试动画**：在游戏中查看小猫移动效果
3. **调整参数**：如果需要，调整动画帧率和大小

现在你的小猫应该可以在游戏中完美显示，没有任何背景问题了！